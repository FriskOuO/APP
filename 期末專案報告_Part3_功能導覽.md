# 🎮 期末專案報告 - Part 3: 功能畫面導覽

## 📱 主要介面總覽

### 介面佈局
```
┌───────────────────────────────────────────────────────┐
│         Smart Parking Adventure - Main UI             │
├──────────────────────────┬────────────────────────────┤
│                          │                            │
│   Visual Novel 區域      │    Cyberpunk Dashboard    │
│      (左側 60%)          │       (右側 40%)          │
│                          │                            │
│  ┌────────────────────┐  │  ┌──────────────────────┐ │
│  │  場景顯示區         │  │  │  系統狀態面板        │ │
│  │  (背景圖片)         │  │  │  - 當前狀態          │ │
│  │                    │  │  │  - 時間戳記          │ │
│  └────────────────────┘  │  └──────────────────────┘ │
│                          │                            │
│  ┌────────────────────┐  │  ┌──────────────────────┐ │
│  │  對話框             │  │  │  HC-SR04 感測器      │ │
│  │  - 打字機效果       │  │  │  - 距離顯示          │ │
│  │  - 彩色文字         │  │  │  - 進度條            │ │
│  └────────────────────┘  │  │  - 警示系統          │ │
│                          │  └──────────────────────┘ │
│  ┌────────────────────┐  │                            │
│  │  選擇按鈕           │  │  ┌──────────────────────┐ │
│  │  [選項A] [選項B]   │  │  │  協議日誌視窗        │ │
│  └────────────────────┘  │  │  - MQTT 訊息         │ │
│                          │  │  - CoAP 指令         │ │
│                          │  │  - 感測器數據        │ │
│                          │  │  - 系統事件          │ │
│                          │  └──────────────────────┘ │
└──────────────────────────┴────────────────────────────┘
```

---

## 🎬 遊戲流程與畫面

### 階段 1: 遊戲開始

#### 畫面 1.1 - 系統載入
```
┌─────────────────────────────────────────┐
│  🌐 系統載入中...                        │
│                                         │
│  [系統]: 正在連接 NTP 伺服器校時...      │
│  [系統]: Platform: Web Browser          │
│  [系統]: World Init: Meme_Parking_Lot   │
│                                         │
│  距離: 500 cm ━━━━━━━━━━━━━━ 100%       │
│                                         │
│  📡 協議日誌:                            │
│  ⏰ [NTP] 時間同步中...                  │
└─────────────────────────────────────────┘
```

**功能說明**:
- NTP 時間同步動畫
- 系統初始化訊息
- 平台檢測 (Web/Native)
- 初始距離設定

---

#### 畫面 1.2 - 停車場入口
```
┌──────────────────────────────────────────────────┐
│  🚗 場景: 停車場入口                              │
│                                                  │
│  [系統]: 你站在這充滿迷因氣息的停車場入口。      │
│  [系統]: 你需要把車停進去...                     │
│                                                  │
│  ┌────────────────┐                             │
│  │  [進入車內]     │                             │
│  └────────────────┘                             │
│                                                  │
│  右側儀表板顯示:                                 │
│  - 狀態: 🌐 系統載入                             │
│  - 距離: 500cm (綠色)                            │
└──────────────────────────────────────────────────┘
```

**互動元素**:
- `[進入車內]` 按鈕: 觸發 `ENTER_CAR` 事件

---

### 階段 2: 車內準備

#### 畫面 2.1 - 車內場景
```
┌──────────────────────────────────────────────────┐
│  🚙 場景: 車內                                    │
│                                                  │
│  [車載智能]: 歡迎上車！準備啟動引擎。            │
│  [車載智能]: 這次我們使用 QTE 挑戰來啟動。       │
│                                                  │
│  選項:                                           │
│  ┌────────────────┐  ┌────────────────┐         │
│  │  [啟動引擎]     │  │  [退出車輛]     │         │
│  └────────────────┘  └────────────────┘         │
│                                                  │
│  (二周目限定)                                     │
│  ┌────────────────┐                             │
│  │  [自動駕駛模式]  │                             │
│  └────────────────┘                             │
└──────────────────────────────────────────────────┘
```

**互動元素**:
- `[啟動引擎]`: 進入 QTE 挑戰
- `[退出車輛]`: 返回停車場
- `[自動駕駛模式]`: 二周目解鎖，跳過 QTE

**右側儀表板**:
- 狀態: 🚗 車輛待命
- 距離: 500cm (綠色)
- 協議日誌: 車輛系統啟動訊息

---

### 階段 3: QTE 挑戰 ⭐

#### 畫面 3.1 - QTE 序列顯示（全螢幕覆蓋）
```
┌───────────────────────────────────────────────────────┐
│                                                       │
│              🎮 QTE 引擎啟動挑戰                       │
│                                                       │
│          按下正確的方向鍵序列來啟動引擎！               │
│                                                       │
│     ┌────┐  ┌────┐  ┌────┐  ┌────┐                 │
│     │ ↑  │  │ ←  │  │ ↓  │  │ →  │                 │
│     └────┘  └────┘  └────┘  └────┘                 │
│      灰色     黃色     灰色     灰色                   │
│            (閃爍)                                     │
│                                                       │
│     進度: ━━━━━━━━━━━━━━━━━ 1/4                      │
│                                                       │
│                按下 ← 鍵！                            │
└───────────────────────────────────────────────────────┘
```

**視覺效果**:
- 當前需要按的鍵：黃色背景 + 放大動畫
- 已完成的鍵：綠色背景 + 縮小消失
- 未到達的鍵：灰色背景
- 進度條顯示完成度

**互動邏輯**:
1. 系統生成 4 個隨機方向鍵
2. 玩家需要按正確的順序
3. 每按對一個，進度 +1
4. 全部按對：引擎啟動成功
5. 按錯：引擎熄火，需重試

---

#### 畫面 3.2 - QTE 成功
```
┌───────────────────────────────────────────────────────┐
│                                                       │
│              ✅ QTE 挑戰成功！                         │
│                                                       │
│     ┌────┐  ┌────┐  ┌────┐  ┌────┐                 │
│     │ ✓  │  │ ✓  │  │ ✓  │  │ ✓  │                 │
│     └────┘  └────┘  └────┘  └────┘                 │
│      綠色     綠色     綠色     綠色                   │
│                                                       │
│     進度: ████████████████████ 4/4                   │
│                                                       │
│              引擎啟動成功！                            │
│              開始駕駛...                              │
└───────────────────────────────────────────────────────┘
```

**右側儀表板更新**:
```
📡 協議日誌:
[QTE] ✅ QTE Challenge: 4/4 Keys Matched!
[System] 🎉 引擎啟動成功
[MQTT] PUBLISH: vehicle/motion/start
[Sensor] 📏 開始距離監測...
```

---

#### 畫面 3.3 - QTE 失敗
```
┌───────────────────────────────────────────────────────┐
│                                                       │
│              ❌ QTE 挑戰失敗！                         │
│                                                       │
│     ┌────┐  ┌────┐  ┌────┐  ┌────┐                 │
│     │ ✓  │  │ ✗  │  │    │  │    │                 │
│     └────┘  └────┘  └────┘  └────┘                 │
│      綠色     紅色     灰色     灰色                   │
│                                                       │
│     進度: ████████░░░░░░░░░░ 2/4                     │
│                                                       │
│              引擎熄火...                              │
│              [再試一次]                               │
└───────────────────────────────────────────────────────┘
```

**失敗處理**:
- 顯示按錯的鍵（紅色標記）
- 提供重試按鈕
- 失敗次數計入統計

---

### 階段 4: 駕駛階段

#### 畫面 4.1 - 自動駕駛
```
┌──────────────────────────────────────────────────┐
│  🚗 場景: 駕駛中                                  │
│                                                  │
│  [車載智能]: 正在前進...                         │
│  [系統]: 距離閘門還有 {{distance}} cm            │
│                                                  │
│  (自動播放動畫)                                   │
│                                                  │
│  右側儀表板即時更新:                             │
│  ┌──────────────────────────────────┐           │
│  │ HC-SR04 超聲波感測器              │           │
│  │                                  │           │
│  │ 距離: 350cm ▼                    │           │
│  │ ██████████████░░░░░░ 70%         │           │
│  │                                  │           │
│  │ 🟢 安全距離                       │           │
│  └──────────────────────────────────┘           │
└──────────────────────────────────────────────────┘
```

**動態效果**:
- 距離每 50ms 減少 10cm
- 進度條動畫
- 顏色漸變:
  - 500-300cm: 綠色（安全）
  - 300-150cm: 黃色（接近）
  - 150-80cm: 橙色（警告）
  - 80-0cm: 紅色（危險）

**協議日誌即時更新**:
```
[Sensor] 📏 Distance: 450cm
[Sensor] 📏 Distance: 400cm
[Sensor] 📏 Distance: 350cm
[MQTT] PUBLISH: sensor/distance/350
[Sensor] 📏 Distance: 300cm
[System] ⚠️ 進入警戒區域
```

---

#### 畫面 4.2 - 接近閘門
```
┌──────────────────────────────────────────────────┐
│  右側儀表板警示:                                 │
│  ┌──────────────────────────────────┐           │
│  │ HC-SR04 超聲波感測器              │           │
│  │                                  │           │
│  │ 距離: 80cm ▼                     │           │
│  │ ████████████████████ 16%         │           │
│  │                                  │           │
│  │ 🔴 危險距離 - 減速！              │           │
│  │                                  │           │
│  │ ⚠️ 警告: 距離過近                 │           │
│  └──────────────────────────────────┘           │
└──────────────────────────────────────────────────┘
```

**警示系統**:
- 紅色脈衝動畫
- 警告音效（可選）
- 文字提示閃爍

---

### 階段 5: 閘門場景

#### 畫面 5.1 - 到達閘門
```
┌──────────────────────────────────────────────────┐
│  🚧 場景: 停車柵欄前                              │
│                                                  │
│  [系統]: 已到達閘門。距離: 50cm                  │
│  [車載智能]: 正在發送 CoAP 請求開啟閘門...       │
│                                                  │
│  ┌────────────────┐                             │
│  │  [開啟閘門]     │                             │
│  └────────────────┘                             │
│                                                  │
│  右側協議日誌:                                   │
│  [Sensor] 📏 Final Distance: 50cm               │
│  [System] 🚧 到達閘門                            │
│  [CoAP] 準備發送開門指令...                      │
└──────────────────────────────────────────────────┘
```

---

#### 畫面 5.2 - 閘門開啟動畫
```
┌──────────────────────────────────────────────────┐
│  🚧 場景: 閘門開啟中                              │
│                                                  │
│  [系統]: 正在開啟閘門...                         │
│  [系統]: 請稍候...                               │
│                                                  │
│  (動畫: 閘門升起)                                │
│      ▓▓▓▓▓▓▓▓▓▓                                 │
│          ↑                                      │
│          ↑                                      │
│                                                  │
│  協議日誌更新:                                   │
│  [CoAP] POST: /parking/gate/open                │
│  [CoAP] Status: Opening...                      │
│  [MQTT] PUBLISH: gate/status/opening            │
│  [System] ⏳ 閘門開啟中 (2秒)                    │
└──────────────────────────────────────────────────┘
```

**IoT 協議模擬**:
1. 發送 CoAP 請求
2. MQTT 發布狀態更新
3. 2 秒延遲模擬開門時間
4. 協議日誌記錄完整過程

---

#### 畫面 5.3 - 閘門已開
```
┌──────────────────────────────────────────────────┐
│  ✅ 場景: 閘門已開                                │
│                                                  │
│  [系統]: 閘門已開啟！可以通過了。                │
│                                                  │
│  ┌────────────────┐                             │
│  │  [駛入停車場]   │                             │
│  └────────────────┘                             │
│                                                  │
│  協議日誌:                                       │
│  [CoAP] ✅ Response: Gate Opened                │
│  [MQTT] PUBLISH: gate/status/open               │
│  [System] ✅ 閘門開啟完成                        │
└──────────────────────────────────────────────────┘
```

---

### 階段 6: 停車完成

#### 畫面 6.1 - 停車成功
```
┌──────────────────────────────────────────────────┐
│  🎉 場景: 停車完成                                │
│                                                  │
│  [系統]: 恭喜！成功停車！                        │
│  [系統]: 停車時間: {{parkingHours}} 小時         │
│  [系統]: 停車費用: NT$ {{fee}}                  │
│                                                  │
│  ┌────────────────────────────────┐             │
│  │  請輸入您的電子郵件地址:        │             │
│  │  [___________________]         │             │
│  │                                │             │
│  │  [發送繳費通知]                 │             │
│  └────────────────────────────────┘             │
│                                                  │
│  儀表板顯示:                                     │
│  - 狀態: 🎉 已停車                               │
│  - 距離: 0cm (完成)                              │
└──────────────────────────────────────────────────┘
```

---

#### 畫面 6.2 - 虛擬手機通知 📱
```
┌───────────────────────────────────┐
│  📱 Virtual Mobile                │
│  ┌─────────────────────────────┐  │
│  │ 🔔 新郵件通知                │  │
│  │                             │  │
│  │ 發件人: parking@iot.tw      │  │
│  │ 主旨: 停車費用通知           │  │
│  │                             │  │
│  │ 親愛的用戶:                  │  │
│  │ 您的停車時間: 2 小時         │  │
│  │ 停車費用: NT$ 60            │  │
│  │                             │  │
│  │ [立即繳費] [稍後提醒]       │  │
│  └─────────────────────────────┘  │
│                                   │
│  (通知從螢幕下方滑入)              │
└───────────────────────────────────┘
```

**虛擬手機功能**:
- 模擬移動裝置通知
- 郵件內容顯示
- 互動按鈕
- 滑入/滑出動畫

---

#### 畫面 6.3 - 遊戲結束
```
┌──────────────────────────────────────────────────┐
│  🎊 遊戲結束                                      │
│                                                  │
│  感謝遊玩 Smart Parking Adventure!               │
│                                                  │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━                  │
│  📊 遊戲統計                                      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━                  │
│  ⏱️  總遊戲時間: 5 分 32 秒                      │
│  🎯 QTE 成功次數: 1                              │
│  ❌ QTE 失敗次數: 2                              │
│  📏 最終距離: 0 cm                               │
│  💰 停車費用: NT$ 60                             │
│                                                  │
│  ✅ 成就解鎖: 「初次停車」                        │
│  💎 解鎖內容: 二周目自動駕駛模式                  │
│                                                  │
│  ┌────────────┐  ┌────────────┐                │
│  │ [重新開始]  │  │ [離開遊戲]  │                │
│  └────────────┘  └────────────┘                │
└──────────────────────────────────────────────────┘
```

---

## 🎨 視覺設計細節

### 賽博龐克風格元素

#### 1. 霓虹燈效果
```css
/* 發光邊框 */
border: 2px solid #00ff88;
box-shadow: 
  0 0 10px rgba(0, 255, 136, 0.5),
  inset 0 0 10px rgba(0, 255, 136, 0.2);

/* 文字發光 */
text-shadow: 
  0 0 10px rgba(5, 217, 232, 0.8),
  0 0 20px rgba(5, 217, 232, 0.5);
```

#### 2. CRT 掃描線
```css
/* 復古螢幕效果 */
background: linear-gradient(
  transparent 50%,
  rgba(0, 255, 136, 0.03) 50%
);
background-size: 100% 4px;
animation: scan 8s linear infinite;
```

#### 3. 打字機效果
- 逐字顯示對話
- 30ms 每字元延遲
- 游標閃爍動畫

#### 4. 顏色配色
```
主要顏色:
- 青色: #05d9e8 (Cyan)
- 綠色: #00ff88 (Neon Green)
- 黃色: #facc15 (Warning Yellow)
- 紅色: #dc2626 (Danger Red)
- 紫色: #c084fc (Mystery Purple)

背景色:
- 深黑: #0a0a0a
- 半透明黑: rgba(0, 0, 0, 0.8)
```

---

## 📊 儀表板詳細說明

### 系統狀態面板
```
┌───────────────────────────────┐
│ 🌐 系統狀態                    │
├───────────────────────────────┤
│ 當前狀態: 駕駛中               │
│ 時間戳記: 2026-01-08 14:32:15 │
│ 遊戲階段: Phase 4/6           │
└───────────────────────────────┘
```

### HC-SR04 感測器面板
```
┌───────────────────────────────┐
│ 📡 HC-SR04 超聲波感測器        │
├───────────────────────────────┤
│ 當前距離: 250 cm ▼             │
│                               │
│ ████████████░░░░░ 50%         │
│                               │
│ 🟡 警戒距離                    │
│                               │
│ 最大: 500cm                   │
│ 最小: 0cm                     │
│ 更新頻率: 50ms                 │
└───────────────────────────────┘
```

### 協議日誌面板
```
┌───────────────────────────────────────┐
│ 📋 IoT 協議日誌 (最新 10 條)           │
├───────────────────────────────────────┤
│ [14:32:15] 🎮 System: 遊戲開始        │
│ [14:32:16] ⏰ NTP: Time Synced        │
│ [14:32:20] 📡 MQTT: Connected         │
│ [14:32:25] ✅ Action: 進入車內        │
│ [14:32:30] 🎯 QTE: Challenge Start   │
│ [14:32:35] ✅ QTE: Success!          │
│ [14:32:36] 📡 MQTT: Publish Start    │
│ [14:32:37] 📏 Sensor: 450cm          │
│ [14:32:38] 📏 Sensor: 400cm          │
│ [14:32:39] 📏 Sensor: 350cm          │
│                                       │
│ [自動滾動到底部]                       │
└───────────────────────────────────────┘
```

---

## 🎮 互動流程圖

```
開始遊戲
    ↓
進入車內
    ↓
啟動引擎
    ↓
QTE 挑戰 ←───┐
    │         │ 失敗重試
    ↓ 成功    │
自動駕駛 ─────┘
    ↓
到達閘門
    ↓
開啟閘門
    ↓
駛入停車
    ↓
輸入郵箱
    ↓
發送通知
    ↓
遊戲結束
    ↓
重新開始 / 離開
```

---

**下一部分**: [Part 4: 頁面功能介紹](期末專案報告_Part4_頁面介紹.md)
